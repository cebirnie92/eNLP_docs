


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>Topic Modelling &mdash; eNLP</title>
    


  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualising Word Counts" href="ex_visualise_distribution.html" />
    <link rel="prev" title="NLP Pipeline" href="ex_nlp_pipeline.html" />
    
    <script src="../_static/require.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> eNLP
          

          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design_decisions.html">Design decisions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">eNLP gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ex_customlangmod.html">Custom Spacy Language Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_get_stopwords.html">Removing Stopwords</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_importantwords.html">TF-IDF Important Words</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_keyphrases.html">Keyphrase Extraction (English)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_nlp_pipeline.html">NLP Pipeline</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Topic Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_visualise_distribution.html">Visualising Word Counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_wordvectoranalysis.html">Word Vector Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex_wordvectorcreation.html">Word Vector Creation</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">eNLP code documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting involved:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html#code-guidelines">Code guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/equinor/eNLP/"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">eNLP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">eNLP gallery</a> &raquo;</li>
        
      <li>Topic Modelling</li>
    
    
    <li class="source-link">
        
            
                
                
                
                    
                
                <a href="https://github.com/Statoil/pylops/edit/master/docs/../../examples/ex_topicmodelling.py"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-ex-topicmodelling-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="topic-modelling">
<span id="sphx-glr-examples-ex-topicmodelling-py"></span><h1>Topic Modelling<a class="headerlink" href="#topic-modelling" title="Permalink to this headline">Â¶</a></h1>
<p>The following example shows how to generate a topic model from a corpus and then determine the topic of a
new document.</p>
<p>NOTE: This is an example to show how to run the procedure however due to the small dataset used
the results are likely to be non-sensical.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">enlp.understanding.topics</span> <span class="k">as</span> <span class="nn">tp</span>
<span class="kn">import</span> <span class="nn">enlp.processing.stdtools</span> <span class="k">as</span> <span class="nn">stdt</span>
<span class="kn">import</span> <span class="nn">spacy</span>
</pre></div>
</div>
<p>Load example text and get stopwords</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example_data/en_nlptexts.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">text</span></a><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">all_stopwords</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stopwords_nb</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stopwords_en</span></a> <span class="o">=</span> <span class="n">stdt</span><span class="o">.</span><span class="n">get_stopwords</span><span class="p">()</span>
</pre></div>
</div>
<p>Preprocess text - for this example we have a very small corpus to allow the documentation
to build therefore we will split the single document into paragraphs for processing to
imitate multiple document input and we will also remove stopwords and punctuation  as the text is too small.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split text into paragraphs to imitate documents</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str.split" title="View documentation for builtins.str.split"><span class="n">text</span><span class="o">.</span><span class="n">split</span></a><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># Remove \n and replace with space</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a><span class="p">]</span>

<span class="c1"># Because example text is small, remove stopwords and punctuation</span>
<span class="n">en</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_md&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stopwords</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stops_nb</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stops_en</span></a> <span class="o">=</span> <span class="n">stdt</span><span class="o">.</span><span class="n">get_stopwords</span><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">stdt</span><span class="o">.</span><span class="n">rm_punctuation</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">stdt</span><span class="o">.</span><span class="n">rm_stopwords</span><span class="p">(</span><span class="n">en</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">stops_en</span></a><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a><span class="p">]</span>
</pre></div>
</div>
<p>Create topic model &amp; visualise keywords per topic</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tp_model</span><span class="p">,</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">bow_topic_modelling</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">docs</span></a><span class="p">,</span><span class="n">no_topics</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># print topics</span>
<span class="n">tp</span><span class="o">.</span><span class="n">print_topic_words</span><span class="p">(</span><span class="n">tp_model</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Topic: 0
 Words: 0.008*&quot;text&quot; + 0.007*&quot;systems&quot; + 0.007*&quot;question&quot; + 0.006*&quot;language&quot; + 0.006*&quot;system&quot; + 0.005*&quot;knowledge&quot; + 0.005*&quot;machine&quot; + 0.005*&quot;natural&quot; + 0.005*&quot;translation&quot; + 0.004*&quot;English&quot;
Topic: 1
 Words: 0.011*&quot;language&quot; + 0.009*&quot;sentiment&quot; + 0.006*&quot;system&quot; + 0.006*&quot;text&quot; + 0.005*&quot;human&quot; + 0.005*&quot;data&quot; + 0.005*&quot;.&quot; + 0.005*&quot;natural&quot; + 0.005*&quot;word&quot; + 0.004*&quot;based&quot;
Topic: 2
 Words: 0.012*&quot;word&quot; + 0.011*&quot;words&quot; + 0.008*&quot;sense&quot; + 0.008*&quot;systems&quot; + 0.007*&quot;based&quot; + 0.007*&quot;text&quot; + 0.006*&quot;sentiment&quot; + 0.006*&quot;language&quot; + 0.006*&quot;learning&quot; + 0.005*&quot;analysis&quot;
</pre></div>
</div>
<p>Determine the topic of a new document</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">fake_doc</span></a> <span class="o">=</span> <span class="s1">&#39;This is a sentence about the importance of artificial intelligence.&#39;</span>
<span class="n">doc_topics</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">determine_topics</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">fake_doc</span></a><span class="p">,</span> <span class="n">tp_model</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>

<span class="c1"># Visualise the top topics for the document</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">doc_topics</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;score&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   topic_no     score
0         0  0.333333
1         1  0.333333
2         2  0.333333
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  13.257 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-ex-topicmodelling-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/82e022f449ae6ff0d1450ac2a638f6ed/ex_topicmodelling.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">ex_topicmodelling.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/111e419d714ba23c1ba84eb8d256b0f0/ex_topicmodelling.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">ex_topicmodelling.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ex_visualise_distribution.html" class="btn btn-neutral float-right" title="Visualising Word Counts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ex_nlp_pipeline.html" class="btn btn-neutral float-left" title="NLP Pipeline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, Claire Birnie
      <span class="lastupdated">
        Last updated on Feb 24, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>